% ========================
% unendlichdimensionale NM
% ========================


\chapter{semidiffbare Newton Methoden in Funktionsr\"aumen}
\label{chap:unendlichdimensional}

Bislang nahm unsere Funktion nur Elemente aus dem $\R^n$ entgegen. Da dies für viele Probleme unzureichend ist, befassen wir uns nun auch damit, dass unsere zu optimierende Funktion Funktionen entgegennimmt. Außerdem waren unsere Nebenbedingungen stetig differenzierbar, was auch nicht immer der Fall ist. Wie wir das verändern betrachten wir später. Wir kümmern uns nun um die Funktionen als Eingaben.

\section{Punktweise Randbedingungen in $L^2$ }
Um das Problem einfach zu behalten, betrachten wir nur $L^2$ und nicht $L^p$. Die Konzepte können übertragen werden, würden jedoch den Rahmen hier sprengen. 

Sei $\Omega \subset \R^n$ messbar mit $0 \le |\Omega| \le \infty$. Wir betrachten das Problem 
\begin{align*}
\min\limits_{u \in L^2(\Omega)} f(u) \quad a \le u \le b \quad \text{a.e. auf } \Omega 
\end{align*}
wobei $f: L^2(\Omega) \rightarrow \R$ zweimal stetig F-diffbar ist und $a,b \in L^{\infty}(\Omega)$ mit $b-a \ge \nu > 0 $, wobei $\nu \in L^{\infty}$. Dieses Problem kann vereinfacht werden, indem wir die Schranken zu konstanten Schranken transformieren.
Da $a \le u$, gilt $0 \le u-a$. Dann formen sich unsere Schranken um zu $0 \le u-a \le b-a$. Dies ist äquivalent zu $0 \le \frac{u-a}{b-a} \le 1$. Damit habe ich konstante Grenzen

Nun lautet das Problem 
\begin{align}
\label{eq:minimierung_konstante_schranken}
\min\limits_{u \in L^2(\Omega)} f(u) \quad \beta_l \le u \le \beta_r \quad \text{a.e. auf } \Omega 
\end{align}
mit $\beta_l < \beta_r $ konstant. 

Jetzt können wir, wie vorher schon oft geschehen, unser Minmierungsproblem als nichtglattes Funktional darstellen. 
Betrachten wir dazu $S:=\left\{ u \in L^2(\Omega) | \beta_l \le u \le \beta_r \right\}$. Da wir in $L^2$ sind, können wir die Dualpaarung mit dem Skalarprodukt identifizieren $\langle \cdot, \cdot \rangle_{U^*,U}= (\cdot,\cdot)_{L^2(\Omega)}$. 
Die Optimalitätsbedingung ist also 
\begin{align*}
	u \in S, \quad \left( \nabla f(u), v-u \right)_{L^2(\Omega)} \ge 0 \quad \forall v \in S
\end{align*}
Jetzt können wir die Projektion für dieses Problem definieren
\begin{align*}
	P_S(v)(x)=P_{[\beta_l, \beta_r]} (v(x)) 
\end{align*}
und erhalten damit insgesamt
\begin{align}
\label{eq:optimal_phi}
	\phi(u)(x):=u-P_{[\beta_l, \beta_r]} (u(x)- \theta \nabla f(u)(x))
\end{align}
mit $\theta>0$ beliebig aber fest. 

Unser Ziel ist es, das verallgemeinerte Differenzial $\partial \phi $ von $\phi$ zu finden, sodass $\phi$ semidiffbar ist. Mit Kettenregel können wir das Problem vereinfachen, indem wir nur das verallgemeinerte Differenzial von $P_{[\beta_l, \beta_r]}(v(\cdot))$ bestimmen. 

\section{Semidiffbarkeit von Superpositionsoperatoren}

\begin{defi}
Sei $\psi: \R^m \rightarrow \R$ lipschitz stetig und ($\partial^{cl} \psi $-) semidiffbar. Für $1 \le q \le p \le \infty$ betrachte 
\begin{align*}
	\Psi: L^p(\Omega)^m \rightarrow L^q(\Omega), \quad \Psi(w)(x):=\psi(w_1(x), \cdots , w_m(x))
\end{align*}
Wir definieren das Differenzial 
\begin{align*}
	& \partial \Psi:  L^p(\Omega)^m \rightrightarrows \mathcal{L}( L^p(\Omega)^m,L^q(\Omega)), \\
	& \partial \Psi(w)= 
	\left\{ 
		M | Mv=g^Tv,\quad g \in L^{\infty}(\Omega)^m, g(x) \in \partial^{cl} \psi(w(x)) \quad \text{f.f.a } x \in \Omega 
	\right\}
\end{align*}
\end{defi}

%\begin{quest}
%Warum will ich, dass $g \in L^{\infty}$ und warum schreibe ich nicht einfach $\{g^T| \cdots\}$? Wozu ist das v gut?
%\end{quest}

Eigentlich hätten wir gerne, dass $L^2(\Omega) \ni v \mapsto P_{[\beta_l, \beta_r]}(v(\cdot)) \in L^2(\Omega)$ semidiffbar ist. Dies stimmt aber leider nicht. 

\begin{lem}
Sei $\Omega \subset \R^n$ nichtleer, offen und beschränkt.  Sei $\psi: \R^m \rightarrow \R$ eine lipschitz stetige, nicht affin lineare Abbildung. Dann ist für alle $q \in [1, \infty)$ der Operator
\begin{align*}
	\Psi: L^q(\Omega) \ni u \mapsto \psi(u(\cdot)) \in L^q(\Omega)
\end{align*}
nicht $\partial \Psi$-semidiffbar
\end{lem}
\begin{proof}
Der Beweis ist zu lang und nicht intuitiv. Allerdings sieht man, dass das Problem die nicht Linearität von $\psi$ ist.  
\end{proof}

\begin{defi}
Sei  $\psi: \R^m \rightarrow \R$ lipschitz stetig und $\partial \Psi$ semidiffbar. Sei $1 \le q \le p \le \infty$. Betrachte
\begin{align*}
	\Psi_G: Y \rightarrow L^q(\Omega), \quad \Psi_G(y)(x)=\psi(G(y)(x))
\end{align*}
wobei $G: Y \rightarrow L^p(\Omega)^m$ stetig F-diffbar und Y Banachraum ist. Wir definieren das Differenzial
\begin{align*}
	& \partial \Psi_G: Y \rightrightarrows \mathcal{L}(Y,L^q(\Omega)) \\
	& \partial \Psi_G(y)=
	\left\{ M \left|
	\begin{array}{ll}
		 Mv= g^T(G'(y)v), \quad g \in L^{\infty}(\Omega)^m,  \\
	    g(x) \in \partial^{cl} \psi(G(y)(x)) \quad \text{f.f.a } x \in \Omega 	
	\end{array}
	\right. 
	\right\}
\end{align*}
\end{defi}

Falls wir G als Identität wählen, ist diese Definition die Gleiche die oben. Die Ableitung von G kommt nach Kettenregel mit rein. 

%nicetohave: leicht andere Vorraussetzungen
\begin{thm}
\label{thm:semidiffbare_verknuepfet_Operatoren}
Sei $\Omega \subset \R^n$ messbar mit $0< |\Omega| < \infty$. Sei $\psi: \R^m \rightarrow \R$ lipschitz stetig und semidiffbar. Sei Y eine Banachraum, $1 \le q < p \le \infty $ und sei der Operator $G:Y \rightarrow L^q (\Omega)^m$ stetig F diffbar und lokal lipschitz stetig. Dann ist der Operator
\begin{align*}
	\Psi_G:Y \rightarrow L^q(\Omega), \quad \Psi_G(y)(x)=\psi(G(y)(x))
\end{align*}
$\partial \Psi_G$ semidiffbar. 
\end{thm}

\section{Punktweise Randbedingungen in $L^2$ überarbeitet}

Unser Ziel war es, Semidiffbarkeit von $\phi$ aus \eqref{eq:optimal_phi} zu zeigen. Dies können wir nur mit ein paar zusätzlichen Annahmen machen.

\begin{thm}
\label{thm:semidiffbarheit_Projektion}
Betrachte das Problem \eqref{eq:minimierung_konstante_schranken} mit $\beta_l < \beta_r$. Es gelte für $\nabla f$, dass $\exists \alpha >0, p>2$ sodass $\nabla f(u)= \alpha u + H(u)$ mit
\begin{align*}
	& H: L^2(\Omega) \rightarrow L^2(\Omega), \quad \text{ stetig F-diffbar} \\
	& H: L^2(\Omega) \rightarrow L^p(\Omega), \quad \text{lokal lipschitzstetig}
\end{align*}
Dann ist der Operator $\phi$ mit $\theta = 1/ \alpha$ aus \eqref{eq:optimal_phi} $\partial \phi$ semidiffbar mit
\begin{align*}
	& \partial \phi: L^2(\Omega) \rightrightarrows \mathcal{L}(L^2(\Omega),L^2(\Omega)), \\
	& \partial \phi (x) =
	\left\{ M \left| 
	\begin{array}{ll}
		M=I+\frac{g}{\alpha} \cdot H'(u), \quad g \in L^{\infty}(\Omega), \\
		g(x) \in \partial^{cl}P_{[\beta_l, \beta_r]} \left( - \frac{1}{\alpha} H(u)(x)\right) \text{ f.f.a } x \in \Omega 	\end{array}
	\right. 
	\right\}
\end{align*}
Hier gilt, dass
\begin{align*}
	\partial^{cl}P_{[\beta_l, \beta_r]} (t)= 
	\left\{
		\begin{array}{ll} 
			\{0\}, & t<\beta_l \text{ oder } t> \beta_r \\
			\{1\}, & \beta_l < t < \beta_r \\
			\lbrack 0,1 \rbrack , & t = \beta_l \text{ oder } t = \beta_r
         \end{array}
    \right.
\end{align*}
\end{thm}
\begin{proof}
Es gilt: 
\begin{align*}
	\phi(u)=u-P_{[\beta_l, \beta_r]}
	\left( 
		u- \frac{1}{\alpha} (\alpha u + H(u))	
	\right) = u-P_{[\beta_l, \beta_r]} 
	\left( 
		- \frac{1}{\alpha} H(u)	
	\right)	
\end{align*}
Setze nun $q=2, \psi=P_{[\beta_l, \beta_r]}$ und $G=- (1/ \alpha )H$. Nun können wir \ref{thm:semidiffbare_verknuepfet_Operatoren} anwenden und erhalten, dass der Operator $\Psi_G: L^2(\Omega) \rightarrow L^2(\Omega)$ $\Psi_G$-semidiffbar ist. Mit Summenregel folgt, dass $\phi=I- \Psi_G$ $(I- \partial \Psi_G)$ semidiffbar ist. Da $\partial \Phi= I - \partial \Psi_G$ ist der Beweis fertig.   
\end{proof}

Wir bräuchten auch noch Regularitätsbedingungen, die werde ich aber hier weglassen, da sie auch nicht im Buch stehen. 

\section{Anwendung für optimale Steuerung}

Diese Theorie können wir jetzt anwenden. Dazu betrachten wir das Problem:
\begin{align*}
& \min\limits_{y \in H_0^1(\Omega), u \in L^2(\Omega)} \quad J(y,u):=\frac{1}{2} \| y-y_d\|_{L^2(\Omega)}+ \frac{\alpha}{2} \| u\|^2_{L^2(\Omega)} \\
& s.t. \quad Ay=r+ Bu, \quad \beta_l\le u \le \beta_r
\end{align*}
Dabei ist y der Zustand und u die Kontrolle. Der Zustand soll möglichst nah an unserer Vorgabe $y_d$ sein. Also soll dieser Abstand minimiert werden, wodurch aber Kosten entstehen. Diese werden durch den hinteren Term der Gleichung bestraft. Wie stark diese Bestrafung ist, hängt von dem (häufig kleinen) Parameter $\alpha $ ab. 

Als Nebenbedingung haben wir einen gleichförmigen linear elliptischen partiellen Differenzialoperator $A: H_0^1(\Omega) \rightarrow H^{-1}(\Omega)$ gegeben, der beschreibt wie sich der Zustand verhält. Z.b. kann $A$ eine Darstellung für $-\Delta $ sein. $B$ beschreibt, wie sich unsere Kontrolle verhält. Außerdem können wir die Kontrolle nur in einem gewissen Rahmen regulieren, weshalb  $\beta_l\le u \le \beta_r$ gelten soll. Zusammengefasst haben wir: 
\begin{align*}
\begin{array}{ll}
	 A: H_0^1(\Omega) \rightarrow H^{-1}(\Omega) 	& \text{elliptischer Differentialoperator} \\
	 r \in H^{-1}(\Omega) 							& \text{gegeben} \\
	 B: L^{p'}(\Omega) \rightarrow H^{-1}(\Omega)  	& \text{stetig und linear}   \\
	 p' \in [1,2) 									& \text{sodass } H_0^1(\Omega) \text{ im Dualraum } L^p(\Omega), p=p'/(p'-1), \\
												 	& \text{von } L^{p'}(\Omega) \text{ stetig eingebettet ist} \\
	 \beta_l < \beta_r 
\end{array}
\end{align*}

Da der Zustand von der Kontrolle abhängt, können wir dies auch ausdrücken mit $y=y(u)=A^{-1}(r+Bu)$. Die Invertierbarkeit von $A$ folgt aus Thm 1.23 aus dem Buch. 

Nun erhalten wir das reduzierte Problem 
\begin{align*}
& \min\limits_{u \in L^2(\Omega)} \hat{J}(u):=J(y(u),u)= \frac{1}{2} \| y(u) - y_d\|_{L^2(\Omega)}+ \frac{\alpha}{2} \|u\|^2_{L^2(\Omega)} \\
& s.t. \quad \beta_l\le u \le \beta_r
\end{align*}

Um die Variationsungleichung aufzustellen brauchen wir 
\begin{align*}
S:= \left\{ u \in L^2(\Omega)| \beta_l \le u \le \beta_r \right\}
\end{align*}

Diese lautet dann:
\begin{align*}
VI(\nabla \hat{J},S): \quad u \in S \quad (\nabla \hat{J}(u),v-u)_{L^2(\Omega)}
\ge 0 \quad \forall v \in S
\end{align*}

Die Variationsungleichung ist eine Optimalitätsbedingung, die schon in einem vorherigen Vortrag eingeführt wurde.
Mit der Projektion $P_S(u)=P_{[\beta_l, \beta_r]}(u)$ kann das Problem neu geschrieben werden als 
\begin{align*}
\phi(u):=u-P_{[\beta_l, \beta_r]}(u- \theta \nabla \hat{J}(u))=0
\end{align*}
wobei $\theta>0$ fest ist. 
Die Variationsungleichung und $\phi(u)=0$ sind äquivalente Formulierungen. Wir benötigen die Darstellung mit der Projektion. 

Nun berechnen wir den Gradienten:
\begin{align*}
 \left(\nabla \hat{J}(u),d \right)_{L^2(\Omega)} & =  \left( y(u)-y_d, y'(u)d \right)_{L^2(\Omega)} + \alpha (u,d)_{L^2(\Omega)} \\
 & = \left( y'(u)^* (y(u)-y_d)+ \alpha u,d \right)_{L^2(\Omega)}
\end{align*}
\begin{quest}
Wie hängt das genau mit dem $p'$ zusammen? warum soll $p' <2$ gelten? Dadurch ist gewährleistet, dass $p \in (1, \infty] $. Das müsste irgendwas mit einem Einbettungssatz sein. 
\end{quest}

Daraus folgt, dass 
\begin{align*}
\nabla \hat{J}(u) & = y'(u)^* (y(u)-y_d)+ \alpha u  \\
				  & = B^* \left( A^{-1}\right)^* \left( A^{-1} (r+Bu)-y_d \right) + \alpha u \\
				  & =: H(u)+ \alpha u
\end{align*}

Da $B \in L(L^{p'}(\Omega), H^{-1}(\Omega))$, ist $B^* \in L(H_0^1(\Omega), L^p(\Omega))$ mit $p=p'/ (p'-1)>2$ 

Daraus folgt, dass der affin lineare Operator
\begin{align*}
	 H(u)= B^* \left( A^{-1}\right)^* \left( A^{-1} (r+Bu)-y_d \right)
\end{align*}
eine stetige, affin lineare Abbildung $L^2(\Omega) \rightarrow L^p(\Omega)$ ist. 

Damit und mit \ref{thm:semidiffbarheit_Projektion} ist der Operator
\begin{align*}
\phi(u):=u-P_{[\beta_l, \beta_r]} (- \frac{1}{\alpha} H(u))=0
\end{align*}
semidiffbar. 

Nun können wir die semidiffbare Newton Methode für unser optimales Steuerungsproblem anwenden:

\begin{algorithm}[H]
\caption{semidiffbare Newton Methode für optimale Steuerung}
\KwData{$u^0 \in L^2(\Omega) $ (möglichst Nah an der Lösung $\overline{u}$)}
\For{$k=0,1,\cdots$} {
    \emph{Wähle $g^k \in L^{\infty} (\Omega)$ } \;
	\emph{Erhalte $s_k$ beim lösen von $ \left( I + \frac{1}{\alpha}g^k \cdot H'(u^k) \right) s^k=-\phi(u^k)$} \;
	$u^{k+1}=u^k+s^k $\;
	}
\end{algorithm}
wobei $g \cdot H'(u)$ für $v \mapsto g \cdot (H'(u)v)$ steht. Hier ist $H'(u^k)=B^* \left( A^{-1}\right)^* A^{-1}B$  
und  
\begin{align*}
 g^k(x)    
	 \left\{
	 	\begin{array}{ll} 
	 		=0, & - (1/ \alpha) H(u^k)(x) \notin \lbrack \beta_l, \beta_r \rbrack \\
         	=1, & - (1/ \alpha) H(u^k)(x) \in ( \beta_l, \beta_r )\\
         	\in \lbrack 0,1 \rbrack & - (1/ \alpha) H(u^k)(x) \in \{\beta_l, \beta_r\}
         \end{array}
     \right.  
\end{align*}

 Die Form des Verfahrens entsteht aus dem semidiffbaren Newtonverfahren und \ref{thm:semidiffbarheit_Projektion}. 

Die Gleichung im Newtonverfahren wirklich zu lösen ist nicht ganz einfach. Die kann man aber vereinfachen, indem man bemerkt, dass $s^k$ das Newtonverfahren dann und nur dann löst, falls $s^k=d_u^k$ und $(d_y^k,d_u^k, d_{\mu}^k)$ löst
\begin{align*}
	\begin{pmatrix}
		I & 0 & A^* \\
		0 & I & - \frac{1}{\alpha}g^k \cdot B^* \\
		A & -B & 0
	\end{pmatrix}
	\begin{pmatrix}
		d_y^k \\
		d_u^k \\
		d_{\mu}^k
	\end{pmatrix}
	=
	\begin{pmatrix}
		0 \\
		- \phi(u^k) \\
		0
	\end{pmatrix}
\end{align*}
Die Äquivalenz kann durch einfaches nachrechnen gezeigt werden. 


\section{Allgemeine Optimierungsprobleme mit Ungleichungsbedingungen in $L^2$}
\label{sec:allgemeine_optimierungsprobleme_mit_ungleichungsbedingungen_in_l2}
Nun wollen wir Probleme der Form
\begin{align}
\label{eq:optimierungsproblem_mit_ungleichungsbedingungen}
 \min\limits_{w \in W} f(w) \quad \text{s.t.} \quad e(w)=0, \quad c_j(w) \le 0 \quad \text{a.e. auf } \Omega_j, \quad j=1, \cdots , m
\end{align}
lösen, wobei $W$ und $Z$ Banachräume sind, $f:W \rightarrow \R, e: W \rightarrow Z$ und $c_j: W \rightarrow L^2(\Omega_j)$ zweimal stetig F-diffbar sind. $\Omega_j \subset \R^{n_j}$ sind messbar und beschränkt. 

Dieses impliziert schon optimale Steuerungsprobleme der Form 
\begin{align*}
 \min\limits_{w \in W} f(w) \quad \text{s.t.} \quad e(w)=0, \quad a_i \le u \le b_i \quad i=1, \cdots , l 
\end{align*}
wobei $y \in Y$ der Zustand und $u \in L^2(\Omega_1) \times \cdots \times L^2(\Omega_l)$ die Kontrollen sind, $a_i, b_i \in L^{\infty}(\Omega_i)$.
Dies geschieht, indem man die Grenzen $a_i, b_i$ durch das $c_j(w) \le 0 $ repräsentiert mit $c_i=a_i-u_i$ bzw $c_j=u_j-b_j$

Um das Problem einfach zu halten, betrachten wir nur den Fall mit m=1. Streng genommen repräsentiert das das optimale Steuerungsproblem nicht, da m ungerade ist (bzw nur den Fall mit einer Schranke), aber das lassen wir außer acht. 


Durch vorherige Theorie wissen wir, dass wir das Problem mittels der Lagrangefunktion darstellen können. Diese lautet hier:
\begin{align*}
	& L: W \times L^2(\Omega) \times Z^* \rightarrow \R \\
	& L(w, \lambda, \mu ) = f(w)+ \left( \lambda, c(w) \right)_{L^2(\Omega)} + \langle \mu, e(w) \rangle_{Z^*, Z}
\end{align*}
 
 Wir nehmen an, dass die Nebenbedingungen an der Lösung $\overline{w} \in W$ gelten. Dann kann das KKT System aufgestellt werden: 
Es existieren $\overline{\lambda} \in L^2(\Omega)$ und $\overline{\mu} \in Z^*$, sodass $(\overline{w}, \overline{\lambda}, \overline{\mu})$ folgenden System genügen.
\begin{align}
\label{eq:lagrange_optimalitaetsbedingungen}
& L_w(\overline{w}, \overline{\lambda}, \overline{\mu})=0 \notag \\
& e(\overline{w})=0 \\
& c(\overline{w}) \le 0, \quad \overline{\lambda} \ge 0, \quad (\overline{\lambda}, c(\overline{w}))_{L^2(\Omega)}=0 \notag
\end{align} 

Die letzte Gleichung kann als Variationsungleichung geschrieben werden, also
\begin{align*}
\left( -c(w),v-w \right)_{L^2(\Omega)} \ge 0 \quad \forall v \in K
\end{align*}
mit $K:= \left\{ u \in L^2(\Omega)| u \ge 0 \right\}$

Dies kann nun wieder mittels Projektion umgeschrieben werden:
\begin{align*}
 \overline{\lambda}- P_{K} \left( \overline{\lambda} + \theta c( \overline{w})\right) = 0
\end{align*}
mit $\theta >0$ fest. Da $P_K(u)=P_{[0,\infty)}(u(\cdot))$ gilt, müssen wir wieder mit Superpositionsoperatoren arbeiten.
Um das KKT zu einer semidiffbaren Gleichung zu machen, brauchen wir einen Glättungsoperator innerhalb der Projektion . Dazu brauchen wir mehr Theorie. Aber zuerst ein Motivationsbeispiel. 


\section{Anwendung für elliptische optimale Steuerung}

\subsection{Verteilte Kontrolle }

Wir betrachten
\begin{align*}
& \min\limits_{y \in H_0^1(\Omega), u \in L^2(\Omega)} \quad J(y,u):=\frac{1}{2} \| y-y_d\|^2_{L^2(\Omega)}+ \frac{\alpha}{2} \| u\|^2_{L^2(\Omega)} \\
& s.t. \quad Ay=r+Bu, \quad u \le b
\end{align*}

Es gilt:
\begin{align*}
\begin{array}{ll}
	b \in L^{\infty}(\Omega) & \\
	A: H_0^1(\Omega) \rightarrow H^{-1}(\Omega) & \text{elliptischer Differentialoperator 2. Ordnung} \\
	r \in H^{-1}(\Omega) & \text{gegeben} \\
	B: L^{p'}(\Omega) \rightarrow H^{-1}(\Omega) & \text{stetig und linear }  \\
	p' \in [1,2) & \text{sodass } H_0^1(\Omega) \text{ im Dualraum } L^p(\Omega), p=p'/(p'-1), \\
	& \text{ von } L^{p'}(\Omega) \text{ stetig eingebettet ist} \\
	\beta_l < \beta_r 
\end{array}
\end{align*}

Jetzt bringen wir das Problem in die Form \eqref{eq:optimierungsproblem_mit_ungleichungsbedingungen} mit $m=1$ mit
\begin{align*}
& w=(y,u) \quad W=Y \times U \quad Y = H_0^1(\Omega) \quad U=L^2(\Omega) \\
& Z=H^{-1}(\Omega) \quad e(y,u)=Ay-Bu-r \quad c(y,u)=u-b  
\end{align*}
Dabei sind e und c stetige affin lineare Operatoren. Die Lagrangefunktion dazu lautet:
\begin{align*}
	L: Y \times U \times L^2(\Omega) \times H_0^1(\Omega)
	L(y,u, \lambda, \mu)= J(y,u)+ \left(\lambda, c(y,u) \right)_{L^2(\Omega)}+ \langle \mu, e(y,u) \rangle_{H^1_0(\Omega), H^{-1}(\Omega)}
\end{align*}
Dadurch können wir die Optimalitätsbedingungen ausrechnen:
\begin{align*}
& L_y(y,u, \lambda, \mu)= J_y(y,u) + c_y(y,u)^* \lambda+e_y(y,u)^* \mu = y-y_d+a^* \mu= 0 \\
& L_u(y,u, \lambda, \mu)= J_u(y,u) + c_u(y,u)^* \lambda+e_u(y,u)^* \mu = \alpha u + \lambda - B^* \mu= 0 \\
& \lambda \ge 0, \quad c(y,u)=u-b \le 0, \quad \left( \lambda, c(y,u) \right)_{L^2(\Omega)}= (\lambda,u-b)_{L^2(\Omega)}=0 \\
& e(y,u)=Ay-Bu-r=0
\end{align*} 
Diese Bedingungen entsprechen denjenigen von \eqref{eq:lagrange_optimalitaetsbedingungen}. 

Daraus ergibt sich, dass $\lambda= B^* \mu - \alpha u$. Wenn wir dies einsetzen erhalten wir
\begin{align*}
& A^* \mu = -(y-y_d) \\
& B^* \mu - \alpha u \ge 0, \quad u \le b, \quad \left( B^* \mu - \alpha u, u-b \right)_{L^2(\Omega)} \\
& Ay=r+Bu  
\end{align*}

Für die Projektion bedeutet dies, dass 
\begin{align*}
b-u- P_{[0, \infty)}(b-u- \theta (B^* \mu - \alpha u))=0
\end{align*}
Für $\theta= 1/ \alpha$ führt das zu
\begin{align*}
\Phi(u,\mu) = b-u- P_{[0, \infty)}(b- \frac{1}{\alpha} B^* \mu )=0
\end{align*}

Da $B^* \in \mathcal{L}(H_0^1(\Omega), L^p(\Omega))$ mit $p=p' / (p'-1))>2$ sehen wir, dass 
\begin{align*}
(u, \mu) \in L^2(\Omega) \times H_0^1(\Omega) \mapsto b-\frac{1}{\alpha}B^* \mu \in L^p(\Omega)
\end{align*}
stetig und affin linear ist. 

\begin{quest}
warum können wir jetzt Thm \ref{thm:semidiffbare_verknuepfet_Operatoren} anwenden? also ist ja nicht $R^m$ (gleiches Problem bei Beweis zu \ref{thm:konvergenz_des_semidiffbaren_newton_verfahrens} 
\end{quest}

 Deshalb ist $\Phi$ $\partial \Phi$-semidiffbar mit 
\begin{align*}
& \partial \Phi: L^2(\Omega) \times H_0^1(\Omega) \rightrightarrows \mathcal{L} \left( L^2(\Omega) \times H_0^1(\Omega) , L^2(\Omega) \right) \\
& \partial \Phi(u, \mu)=
\left\{ M \left|
	\begin{array}{ll}
 		M =  (I,-\frac{g}{\alpha} \cdot B^*), g \in L^{\infty}(\Omega),  \\
		g(x) \in \partial^{cl} P_{[0, \infty)} (b(x) - \frac{1}{\alpha} (B^* \mu) (x)) \text{ f.f.a.} x \in \Omega 	
	\end{array}
	\right. 
\right\}
\end{align*}

Hierbei ist die Projektion gegeben durch:
\begin{align*}
	\partial^{cl}P_{[0, \infty)} (t)= 
	\left\{
		\begin{array}{ll} 
			\{0\}, & t<0 \\
			\{1\}, & t>0 \\
			\lbrack 0,1 \rbrack , & t =0
         \end{array}
    \right.
\end{align*}

Das semidiffbare Newtonsystem sieht dann wie folgt aus:
\begin{align*}
	\begin{pmatrix}
 		I & 0  & A^* \\
 		0 & I  & - \frac{g^k}{\alpha} \cdot B^* \\
 		A & -B & 0
	\end{pmatrix}
	\begin{pmatrix}
		s_y \\ 
		s_u \\
		s_{\mu}
	\end{pmatrix}
	= -
	\begin{pmatrix}
		y^k-y_d+A^* \mu^k \\
		u^k - b + P_{[0, \infty)}(b-\frac{1}{\alpha}B^* \mu^k) \\
		A y^k - B u^k - r
	\end{pmatrix}
\end{align*}

\begin{quest}
(hier nochmal genau verstehen. Die zweite Zeile ist nur $M_k s^k= \Phi$. Die anderen Zeilen kann ich nicht genau sagen. Wie sieht dann der Alorithmus dazu aus? )
\end{quest}

Bei diesem System ist die linke Seite genau die Gleiche, wie bei dem System davor. 